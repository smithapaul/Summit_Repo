DROP FUNCTION CSMRT_OWNER.GET_TEST_SCORE
/

--
-- GET_TEST_SCORE  (Function) 
--
CREATE OR REPLACE FUNCTION CSMRT_OWNER.GET_TEST_SCORE
(
IN_PERSON_ID IN VARCHAR2, 
IN_TEST_ID IN VARCHAR2, 
IN_TEST_COMPONENT IN VARCHAR2, 
IN_SCORE_TYPE VARCHAR2 ) 
RETURN NUMBER IS RET_SCORE NUMBER;
BEGIN

      SELECT CASE WHEN IN_SCORE_TYPE = 'NUMERIC' THEN NUMERIC_SCORE
                  WHEN IN_SCORE_TYPE = 'PERCENTILE' THEN SCORE_PERCENTILE
             END
      INTO RET_SCORE
      FROM CSMRT_OWNER.UM_F_EXT_TESTSCORE              
      WHERE PERSON_ID = IN_PERSON_ID
        AND TEST_CMPNT_ID = IN_TEST_COMPONENT
        AND TEST_ID = IN_TEST_ID
        AND BEST_SCORE_FLG = 'Y' 

;

  RETURN RET_SCORE;
        
END GET_TEST_SCORE;
/
