DROP PROCEDURE CSMRT_OWNER.UM_D_CRSE_P
/

--
-- UM_D_CRSE_P  (Procedure) 
--
CREATE OR REPLACE PROCEDURE CSMRT_OWNER."UM_D_CRSE_P" AUTHID CURRENT_USER IS

------------------------------------------------------------------------
-- George Adams
-- COPY OF ORIGINAL AS OF 3/26/2018
-- Loads stage table UM_D_CRSE from PeopleSoft table PS_CRSE_CATALOG and PS_CRSE_OFFER.
--
-- V01  SMT-xxxx 12/06/2017,    James Doucette
--                              Converted from UM_D_CRSE.SQL
-- V02 3/26/2018 ,               Srikanth,Pabbu Updated with new merge sql  
------------------------------------------------------------------------

        strMartId                       Varchar2(50)    := 'CSW';
        strProcessName                  Varchar2(100)   := 'UM_D_CRSE';
        intProcessSid                   Integer;
        dtProcessStart                  Date            := SYSDATE;
        strMessage01                    Varchar2(4000);
        strMessage02                    Varchar2(512);
        strMessage03                    Varchar2(512)   :='';
        strNewLine                      Varchar2(2)     := chr(13) || chr(10);
        strSqlCommand                   Varchar2(32767) :='';
        strSqlDynamic                   Varchar2(32767) :='';
        strClientInfo                   Varchar2(100);
        intRowCount                     Integer;
        intTotalRowCount                Integer         := 0;
        numSqlCode                      Number;
        strSqlErrm                      Varchar2(4000);
        intTries                        Integer;

BEGIN
strSqlCommand := 'DBMS_APPLICATION_INFO.SET_CLIENT_INFO';
DBMS_APPLICATION_INFO.SET_CLIENT_INFO (strProcessName);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_INIT';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_INIT
        (
                i_MartId                => strMartId,
                i_ProcessName           => strProcessName,
                i_ProcessStartTime      => dtProcessStart,
                o_ProcessSid            => intProcessSid
        );

strMessage01    := 'Merging data into CSMRT_OWNER.UM_D_CRSE';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand   := 'merge into CSMRT_OWNER.UM_D_CRSE';
merge /* parallel(T,8) */ /*+ use_hash(S,T) */ into CSMRT_OWNER.UM_D_CRSE T  
using (
with X as (  
select FIELDNAME, FIELDVALUE, EFFDT, SRC_SYS_ID, 
       XLATLONGNAME, XLATSHORTNAME, DATA_ORIGIN, 
       row_number() over (partition by FIELDNAME, FIELDVALUE, SRC_SYS_ID
                              order by DATA_ORIGIN desc, (case when EFFDT > trunc(SYSDATE) then to_date('01-JAN-1800') else EFFDT end) desc) X_ORDER
  from CSSTG_OWNER.PSXLATITEM
 where DATA_ORIGIN <> 'D'),
       CAT as (
select CRSE_ID, 
       EFFDT, 
       SRC_SYS_ID,
       EFF_STATUS, 
       DESCR, 
       EQUIV_CRSE_ID, 
       CONSENT, 
       ALLOW_MULT_ENROLL, 
       UNITS_MINIMUM, 
       UNITS_MAXIMUM, 
       UNITS_ACAD_PROG, 
       UNITS_FINAID_PROG, 
       CRSE_REPEATABLE, 
       UNITS_REPEAT_LIMIT, 
       CRSE_REPEAT_LIMIT, 
       GRADING_BASIS, 
       GRADE_ROSTER_PRINT, 
       SSR_COMPONENT, 
       COURSE_TITLE_LONG, 
       CRSE_CONTACT_HRS, 
       RQMNT_DESIGNTN, 
       CRSE_COUNT, 
       INSTRUCTOR_EDIT, 
       FEES_EXIST, 
       COMPONENT_PRIMARY, 
       DATA_ORIGIN, 
       to_char(substr(DESCRLONG,1,4000)) DESCRLONG
from CSSTG_OWNER.PS_CRSE_CATALOG C
where trunc(EFFDT) <= trunc(sysdate)),
OFFER as (
select CAT.CRSE_ID, 
       CAT.EFFDT, 
       O.CRSE_OFFER_NBR, 
       CAT.SRC_SYS_ID, 
       CAT.EFF_STATUS, 
       CAT.DESCR, 
       CAT.EQUIV_CRSE_ID, 
       CAT.CONSENT, 
       CAT.ALLOW_MULT_ENROLL, 
       CAT.UNITS_MINIMUM, 
       CAT.UNITS_MAXIMUM, 
       CAT.UNITS_ACAD_PROG, 
       CAT.UNITS_FINAID_PROG, 
       CAT.CRSE_REPEATABLE, 
       CAT.UNITS_REPEAT_LIMIT, 
       CAT.CRSE_REPEAT_LIMIT, 
       CAT.GRADING_BASIS, 
       CAT.GRADE_ROSTER_PRINT, 
       CAT.SSR_COMPONENT, 
       CAT.COURSE_TITLE_LONG, 
       CAT.CRSE_CONTACT_HRS, 
       CAT.RQMNT_DESIGNTN, 
       CAT.CRSE_COUNT, 
       CAT.INSTRUCTOR_EDIT, 
       CAT.FEES_EXIST, 
       CAT.COMPONENT_PRIMARY, 
       CAT.DATA_ORIGIN,
       CAT.DESCRLONG,
       O.INSTITUTION, 
       O.ACAD_GROUP, 
       O.SUBJECT, 
       O.CATALOG_NBR, 
       O.COURSE_APPROVED, 
       O.CAMPUS, 
       O.SCHEDULE_PRINT, 
       O.CATALOG_PRINT, 
       O.SCHED_PRINT_INSTR, 
       O.ACAD_ORG, 
       O.ACAD_CAREER, 
       O.SPLIT_OWNER, 
       O.SCHED_TERM_ROLL, 
       O.RQRMNT_GROUP, 
       O.CIP_CODE, 
       O.USE_BLIND_GRADING, 
       O.SCHEDULE_COURSE, 
       O.OEE_IND,
       row_number() over (partition by CAT.CRSE_ID, O.CRSE_OFFER_NBR, CAT.SRC_SYS_ID
                              order by decode(CAT.DATA_ORIGIN,'D',9,0), CAT.EFFDT desc) OFFER_ORDER
  from CAT
  join CSSTG_OWNER.PS_CRSE_OFFER O
    on CAT.CRSE_ID = O.CRSE_ID
   and CAT.EFFDT = O.EFFDT
   and CAT.SRC_SYS_ID = O.SRC_SYS_ID), 
CIP as ( 
select CIP_CODE, EFFDT, SRC_SYS_ID, 
       decode(max(EFFDT) over (partition by CIP_CODE, SRC_SYS_ID
                                   order by EFFDT 
                               rows between unbounded preceding and 1 preceding),NULL,to_date('01-JAN-1800'),EFFDT) EFFDT_START,   
       nvl(min(EFFDT-1) over (partition by CIP_CODE, SRC_SYS_ID
                                  order by EFFDT
                              rows between 1 following and unbounded following),to_date('31-DEC-9999')) EFFDT_END,   
       DESCR, SEV_VALID_CIP_CD, UM_STEM
  from CSSTG_OWNER.PS_CIP_CODE_TBL 
 where DATA_ORIGIN <> 'D'), 
SUB as ( 
select INSTITUTION, 
       SUBJECT, 
       EFFDT, 
       SRC_SYS_ID, 
       EFF_STATUS, 
       DESCR, 
       DESCRSHORT, 
       DESCRFORMAL,
       row_number() over (partition by INSTITUTION, SUBJECT, SRC_SYS_ID
                              order by decode(EFF_STATUS,'I',9,0), EFFDT desc) SUB_ORDER 
  from CSSTG_OWNER.PS_SUBJECT_TBL 
 where DATA_ORIGIN <> 'D'),
DES as (
select RQMNT_DESIGNTN, EFFDT, SRC_SYS_ID, 
       EFF_STATUS, DESCR, DESCRSHORT, DESCRFORMAL,
       row_number() over (partition by RQMNT_DESIGNTN, SRC_SYS_ID
                              order by decode(EFF_STATUS,'I',9,0), EFFDT desc) DES_ORDER 
  from CSSTG_OWNER.PS_RQMNT_DESIG_TBL
 where DATA_ORIGIN <> 'D'),
EQ as ( 
select EQUIV_CRSE_ID, EFFDT, SRC_SYS_ID, 
       EFF_STATUS, DESCR, DESCRSHORT,
       row_number() over (partition by EQUIV_CRSE_ID, SRC_SYS_ID
                              order by decode(EFF_STATUS,'I',9,0), EFFDT desc) EQ_ORDER 
  from CSSTG_OWNER.PS_CRSE_EQUIV_TBL
 where DATA_ORIGIN <> 'D'),
S as ( 
select ROWNUM CRSE_SID,             -- Temp!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!  
       OFFER.CRSE_ID CRSE_CD, 
       OFFER.CRSE_OFFER_NBR CRSE_OFFER_NUM,
       OFFER.SRC_SYS_ID, 
       OFFER.EFFDT, 
       OFFER.EFF_STATUS, 
       substr(OFFER.DESCR,1,10) CRSE_SD, 
       OFFER.DESCR CRSE_LD,
       OFFER.CRSE_ID || ' (' || OFFER.DESCR || ')' CRSE_CD_DESC,
       OFFER.COURSE_TITLE_LONG CRSE_TTL_LD, 
       OFFER.INSTITUTION INSTITUTION_CD, 
       nvl(I.INSTITUTION_SID,2147483646) INSTITUTION_SID, 
       nvl(C.ACAD_CAR_SID,2147483646) ACAD_CAR_SID, 
       nvl(G.ACAD_GRP_SID,2147483646) ACAD_GRP_SID, 
       nvl(O.ACAD_ORG_SID,2147483646) ACAD_ORG_SID, 
       nvl(M.CAMPUS_SID,2147483646) CAMPUS_SID, 
       nvl(RQ.RQRMNT_GROUP_SID,2147483646) RQRMNT_GROUP_SID, 
       nvl(SSR1.SSR_COMP_SID,2147483646) SSR_COMP_SID, 
       nvl(SSR2.SSR_COMP_SID,2147483646) SSR_COMP_PRIM_SID, 
       OFFER.ALLOW_MULT_ENROLL ALLOW_MULT_ENROLL_FLG, 
       OFFER.USE_BLIND_GRADING BLIND_GRADING_FLG, 
       OFFER.CATALOG_NBR CATALOG_NUM, 
       OFFER.CATALOG_PRINT CATALOG_PRINT_FLG, 
       OFFER.CIP_CODE CIP_CD, 
       nvl(CIP.DESCR,'-') CIP_LD, 
       OFFER.CONSENT, 
       nvl(X1.XLATSHORTNAME,'-') CONSENT_SD, 
       nvl(X1.XLATLONGNAME,'-') CONSENT_LD, 
       OFFER.COURSE_APPROVED CRSE_APPRV_CD, 
       nvl(X2.XLATSHORTNAME,'-') CRSE_APPRV_SD, 
       nvl(X2.XLATLONGNAME,'-') CRSE_APPRV_LD, 
       OFFER.SUBJECT || '.' || OFFER.CATALOG_NBR || '-' || OFFER.DESCR CRSE_DISPLAY_NAME,
          (CASE
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '000' AND '199'
              THEN
                 '100 (Lower)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '200' AND '299'
              THEN
                 '200 (Lower)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '300' AND '399'
              THEN
                 '300 (Upper)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '400' AND '499'
              THEN
                 '400 (Upper)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '500' AND '599'
              THEN
                 '500 (Graduate)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '600' AND '699'
              THEN
                 '600 (Graduate)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '700' AND '799'
              THEN
                 '700 (Graduate)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '800' AND '899'
              THEN
                 '800 (Graduate)'
              WHEN SUBSTR (OFFER.CATALOG_NBR, 1, 3) BETWEEN '900' AND '999'
              THEN
                 '900 (Other)'
              ELSE
                 '900 (Other)'
           END)
             CRSE_LVL,
       OFFER.CRSE_REPEATABLE CRSE_REPEAT_FLG, 
       OFFER.CRSE_REPEAT_LIMIT,
       OFFER.EQUIV_CRSE_ID,
       EQ.DESCRSHORT EQUIV_CRSE_SD,
       EQ.DESCR EQUIV_CRSE_LD,  
       OFFER.FEES_EXIST FEES_EXIST_FLG, 
       OFFER.GRADING_BASIS GRADE_BASIS_CD, 
       nvl(X3.XLATSHORTNAME,'-') GRADE_BASIS_SD, 
       nvl(X3.XLATLONGNAME,'-') GRADE_BASIS_LD, 
       OFFER.GRADE_ROSTER_PRINT, 
       nvl(X4.XLATSHORTNAME,'-') GRADE_ROSTER_PRINT_SD, 
       nvl(X4.XLATLONGNAME,'-') GRADE_ROSTER_PRINT_LD, 
       OFFER.INSTRUCTOR_EDIT, 
       nvl(X5.XLATSHORTNAME,'-') INSTRUCTOR_EDIT_SD, 
       nvl(X5.XLATLONGNAME,'-') INSTRUCTOR_EDIT_LD, 
       OFFER.OEE_IND,
       OFFER.RQMNT_DESIGNTN, 
       DES.DESCRSHORT RQMNT_DESIGNTN_SD, 
       DES.DESCR RQMNT_DESIGNTN_LD, 
       DES.DESCRFORMAL RQMNT_DESIGNTN_FD,
       OFFER.SUBJECT SBJCT_CD, 
       nvl(SUB.DESCRSHORT,'-') SBJCT_SD, 
       nvl(SUB.DESCR,'-') SBJCT_LD, 
       nvl(SUB.DESCRFORMAL,'-') SBJCT_FD, 
       nvl(trim(OFFER.SUBJECT),'-') || ' (' || nvl(trim(SUB.DESCR),'-') || ')' SBJCT_CD_DESC,
       OFFER.SCHEDULE_COURSE SCHEDULE_CRSE_FLG, 
       OFFER.SCHEDULE_PRINT SCHEDULE_PRINT_FLG, 
       OFFER.SCHED_PRINT_INSTR SCHED_PRINT_INSTR_FLG, 
       OFFER.SCHED_TERM_ROLL SCHED_TERM_ROLL_FLG, 
       OFFER.SPLIT_OWNER, 
       nvl(CIP.SEV_VALID_CIP_CD,'-') SEV_VALID_CIP_FLG, 
       nvl(CIP.UM_STEM,'-') UM_STEM_FLG, 
       OFFER.UNITS_ACAD_PROG ACAD_PRGRS_UNITS, 
       OFFER.CRSE_COUNT CRSE_CNT, 
       OFFER.CRSE_CONTACT_HRS, 
       OFFER.UNITS_FINAID_PROG FA_PRGRS_UNITS, 
       OFFER.UNITS_MINIMUM MIN_UNITS, 
       OFFER.UNITS_MAXIMUM MAX_UNITS, 
       OFFER.UNITS_REPEAT_LIMIT,
       OFFER.DATA_ORIGIN,
       SYSDATE CREATED_EW_DTTM,
       SYSDATE LASTUPD_EW_DTTM,
       OFFER.DESCRLONG 
  from OFFER
  left outer join CIP
    on OFFER.CIP_CODE = CIP.CIP_CODE
   and OFFER.SRC_SYS_ID = CIP.SRC_SYS_ID
   and OFFER.EFFDT between CIP.EFFDT_START and CIP.EFFDT_END
  left outer join SUB
    on OFFER.INSTITUTION = SUB.INSTITUTION  
   and OFFER.SUBJECT = SUB.SUBJECT  
   and OFFER.SRC_SYS_ID = SUB.SRC_SYS_ID  
   and SUB.SUB_ORDER = 1
  left outer join DES
    on OFFER.RQMNT_DESIGNTN = DES.RQMNT_DESIGNTN 
   and OFFER.SRC_SYS_ID = DES.SRC_SYS_ID
   and DES.DES_ORDER = 1
  left outer join EQ
    on OFFER.EQUIV_CRSE_ID = EQ.EQUIV_CRSE_ID 
   and OFFER.SRC_SYS_ID = EQ.SRC_SYS_ID
   and EQ.EQ_ORDER = 1
  left outer join PS_D_INSTITUTION I  
    on OFFER.INSTITUTION = I.INSTITUTION_CD
   and OFFER.SRC_SYS_ID = I.SRC_SYS_ID
   and I.DATA_ORIGIN <> 'D'
  left outer join PS_D_ACAD_CAR C  
    on OFFER.INSTITUTION = C.INSTITUTION_CD
   and OFFER.ACAD_CAREER = C.ACAD_CAR_CD
   and OFFER.SRC_SYS_ID = C.SRC_SYS_ID
   and C.DATA_ORIGIN <> 'D'
  left outer join PS_D_ACAD_GRP G  
    on OFFER.INSTITUTION = G.INSTITUTION_CD
   and OFFER.ACAD_GROUP = G.ACAD_GRP_CD
   and OFFER.SRC_SYS_ID = G.SRC_SYS_ID
   and G.EFFDT_ORDER = 1 
   and G.DATA_ORIGIN <> 'D'
  left outer join PS_D_ACAD_ORG O  
    on OFFER.ACAD_ORG = O.ACAD_ORG_CD
   and OFFER.SRC_SYS_ID = O.SRC_SYS_ID
   and O.EFFDT_ORDER = 1 
   and O.DATA_ORIGIN <> 'D'
  left outer join PS_D_CAMPUS M  
    on OFFER.INSTITUTION = M.INSTITUTION_CD
   and OFFER.CAMPUS = M.CAMPUS_CD
   and OFFER.SRC_SYS_ID = M.SRC_SYS_ID
   and M.DATA_ORIGIN <> 'D'
  left outer join UM_D_RQ_GRP RQ    
    on OFFER.RQRMNT_GROUP = RQ.RQRMNT_GROUP
   and OFFER.SRC_SYS_ID = RQ.SRC_SYS_ID
   and RQ.DATA_ORIGIN <> 'D'
  left outer join PS_D_SSR_COMP SSR1  
    on OFFER.SSR_COMPONENT = SSR1.SSR_COMP_CD
   and OFFER.SRC_SYS_ID = SSR1.SRC_SYS_ID
   and SSR1.DATA_ORIGIN <> 'D'
  left outer join PS_D_SSR_COMP SSR2  
    on OFFER.COMPONENT_PRIMARY = SSR2.SSR_COMP_CD
   and OFFER.SRC_SYS_ID = SSR2.SRC_SYS_ID
   and SSR2.DATA_ORIGIN <> 'D'
  left outer join X X1
    on OFFER.CONSENT = X1.FIELDVALUE
   and OFFER.SRC_SYS_ID = X1.SRC_SYS_ID
   and X1.FIELDNAME = 'CONSENT'
   and X1.X_ORDER = 1
  left outer join X X2
    on OFFER.COURSE_APPROVED = X2.FIELDVALUE
   and OFFER.SRC_SYS_ID = X2.SRC_SYS_ID
   and X2.FIELDNAME = 'COURSE_APPROVED'
   and X2.X_ORDER = 1
  left outer join X X3
    on OFFER.GRADING_BASIS = X3.FIELDVALUE
   and OFFER.SRC_SYS_ID = X3.SRC_SYS_ID
   and X3.FIELDNAME = 'GRADING_BASIS'
   and X3.X_ORDER = 1
  left outer join X X4
    on OFFER.GRADE_ROSTER_PRINT = X4.FIELDVALUE
   and OFFER.SRC_SYS_ID = X4.SRC_SYS_ID
   and X4.FIELDNAME = 'GRADE_ROSTER_PRINT'
   and X4.X_ORDER = 1
  left outer join X X5
    on OFFER.INSTRUCTOR_EDIT = X5.FIELDVALUE
   and OFFER.SRC_SYS_ID = X5.SRC_SYS_ID
   and X5.FIELDNAME = 'INSTRUCTOR_EDIT'
   and X5.X_ORDER = 1
 where OFFER.OFFER_ORDER = 1)
--select nvl(D.CRSE_SID, max(D.CRSE_SID) over (partition by 1) +                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
--       row_number() over (partition by 1 order by D.CRSE_SID nulls first)) CRSE_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
select nvl(D.CRSE_SID,(select nvl(max(CRSE_SID),0) from CSMRT_OWNER.UM_D_CRSE where CRSE_SID <> 2147483646) +
       row_number() over (partition by 1 order by D.CRSE_SID nulls first)) CRSE_SID,          -- Dec 2020                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       nvl(D.CRSE_CD, S.CRSE_CD) CRSE_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       nvl(D.CRSE_OFFER_NUM, S.CRSE_OFFER_NUM) CRSE_OFFER_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
       nvl(D.SRC_SYS_ID, S.SRC_SYS_ID) SRC_SYS_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       decode(D.EFFDT, S.EFFDT, D.EFFDT, S.EFFDT) EFFDT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       decode(D.EFF_STATUS, S.EFF_STATUS, D.EFF_STATUS, S.EFF_STATUS) EFF_STATUS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(D.CRSE_SD, S.CRSE_SD, D.CRSE_SD, S.CRSE_SD) CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       decode(D.CRSE_LD, S.CRSE_LD, D.CRSE_LD, S.CRSE_LD) CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       decode(D.CRSE_CD_DESC, S.CRSE_CD_DESC, D.CRSE_CD_DESC, S.CRSE_CD_DESC) CRSE_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(D.CRSE_TTL_LD, S.CRSE_TTL_LD, D.CRSE_TTL_LD, S.CRSE_TTL_LD) CRSE_TTL_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       decode(D.INSTITUTION_CD, S.INSTITUTION_CD, D.INSTITUTION_CD, S.INSTITUTION_CD) INSTITUTION_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.INSTITUTION_SID, S.INSTITUTION_SID, D.INSTITUTION_SID, S.INSTITUTION_SID) INSTITUTION_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       decode(D.ACAD_CAR_SID, S.ACAD_CAR_SID, D.ACAD_CAR_SID, S.ACAD_CAR_SID) ACAD_CAR_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(D.ACAD_GRP_SID, S.ACAD_GRP_SID, D.ACAD_GRP_SID, S.ACAD_GRP_SID) ACAD_GRP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(D.ACAD_ORG_SID, S.ACAD_ORG_SID, D.ACAD_ORG_SID, S.ACAD_ORG_SID) ACAD_ORG_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(D.CAMPUS_SID, S.CAMPUS_SID, D.CAMPUS_SID, S.CAMPUS_SID) CAMPUS_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(D.RQRMNT_GROUP_SID, S.RQRMNT_GROUP_SID, D.RQRMNT_GROUP_SID, S.RQRMNT_GROUP_SID) RQRMNT_GROUP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(D.SSR_COMP_SID, S.SSR_COMP_SID, D.SSR_COMP_SID, S.SSR_COMP_SID) SSR_COMP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(D.SSR_COMP_PRIM_SID, S.SSR_COMP_PRIM_SID, D.SSR_COMP_PRIM_SID, S.SSR_COMP_PRIM_SID) SSR_COMP_PRIM_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.ALLOW_MULT_ENROLL_FLG, S.ALLOW_MULT_ENROLL_FLG, D.ALLOW_MULT_ENROLL_FLG, S.ALLOW_MULT_ENROLL_FLG) ALLOW_MULT_ENROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       decode(D.BLIND_GRADING_FLG, S.BLIND_GRADING_FLG, D.BLIND_GRADING_FLG, S.BLIND_GRADING_FLG) BLIND_GRADING_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.CATALOG_NUM, S.CATALOG_NUM, D.CATALOG_NUM, S.CATALOG_NUM) CATALOG_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       decode(D.CATALOG_PRINT_FLG, S.CATALOG_PRINT_FLG, D.CATALOG_PRINT_FLG, S.CATALOG_PRINT_FLG) CATALOG_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.CIP_CD, S.CIP_CD, D.CIP_CD, S.CIP_CD) CIP_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(D.CIP_LD, S.CIP_LD, D.CIP_LD, S.CIP_LD) CIP_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(D.CONSENT, S.CONSENT, D.CONSENT, S.CONSENT) CONSENT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       decode(D.CONSENT_SD, S.CONSENT_SD, D.CONSENT_SD, S.CONSENT_SD) CONSENT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(D.CONSENT_LD, S.CONSENT_LD, D.CONSENT_LD, S.CONSENT_LD) CONSENT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(D.CRSE_APPRV_CD, S.CRSE_APPRV_CD, D.CRSE_APPRV_CD, S.CRSE_APPRV_CD) CRSE_APPRV_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.CRSE_APPRV_SD, S.CRSE_APPRV_SD, D.CRSE_APPRV_SD, S.CRSE_APPRV_SD) CRSE_APPRV_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.CRSE_APPRV_LD, S.CRSE_APPRV_LD, D.CRSE_APPRV_LD, S.CRSE_APPRV_LD) CRSE_APPRV_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.CRSE_DISPLAY_NAME, S.CRSE_DISPLAY_NAME, D.CRSE_DISPLAY_NAME, S.CRSE_DISPLAY_NAME) CRSE_DISPLAY_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.CRSE_LVL, S.CRSE_LVL, D.CRSE_LVL, S.CRSE_LVL) CRSE_LVL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.CRSE_REPEAT_FLG, S.CRSE_REPEAT_FLG, D.CRSE_REPEAT_FLG, S.CRSE_REPEAT_FLG) CRSE_REPEAT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       decode(D.CRSE_REPEAT_LIMIT, S.CRSE_REPEAT_LIMIT, D.CRSE_REPEAT_LIMIT, S.CRSE_REPEAT_LIMIT) CRSE_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.EQUIV_CRSE_ID, S.EQUIV_CRSE_ID, D.EQUIV_CRSE_ID, S.EQUIV_CRSE_ID) EQUIV_CRSE_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.EQUIV_CRSE_SD, S.EQUIV_CRSE_SD, D.EQUIV_CRSE_SD, S.EQUIV_CRSE_SD) EQUIV_CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.EQUIV_CRSE_LD, S.EQUIV_CRSE_LD, D.EQUIV_CRSE_LD, S.EQUIV_CRSE_LD) EQUIV_CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.FEES_EXIST_FLG, S.FEES_EXIST_FLG, D.FEES_EXIST_FLG, S.FEES_EXIST_FLG) FEES_EXIST_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.GRADE_BASIS_CD, S.GRADE_BASIS_CD, D.GRADE_BASIS_CD, S.GRADE_BASIS_CD) GRADE_BASIS_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.GRADE_BASIS_SD, S.GRADE_BASIS_SD, D.GRADE_BASIS_SD, S.GRADE_BASIS_SD) GRADE_BASIS_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.GRADE_BASIS_LD, S.GRADE_BASIS_LD, D.GRADE_BASIS_LD, S.GRADE_BASIS_LD) GRADE_BASIS_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.GRADE_ROSTER_PRINT, S.GRADE_ROSTER_PRINT, D.GRADE_ROSTER_PRINT, S.GRADE_ROSTER_PRINT) GRADE_ROSTER_PRINT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(D.GRADE_ROSTER_PRINT_SD, S.GRADE_ROSTER_PRINT_SD, D.GRADE_ROSTER_PRINT_SD, S.GRADE_ROSTER_PRINT_SD) GRADE_ROSTER_PRINT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       decode(D.GRADE_ROSTER_PRINT_LD, S.GRADE_ROSTER_PRINT_LD, D.GRADE_ROSTER_PRINT_LD, S.GRADE_ROSTER_PRINT_LD) GRADE_ROSTER_PRINT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       decode(D.INSTRUCTOR_EDIT, S.INSTRUCTOR_EDIT, D.INSTRUCTOR_EDIT, S.INSTRUCTOR_EDIT) INSTRUCTOR_EDIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       decode(D.INSTRUCTOR_EDIT_SD, S.INSTRUCTOR_EDIT_SD, D.INSTRUCTOR_EDIT_SD, S.INSTRUCTOR_EDIT_SD) INSTRUCTOR_EDIT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(D.INSTRUCTOR_EDIT_LD, S.INSTRUCTOR_EDIT_LD, D.INSTRUCTOR_EDIT_LD, S.INSTRUCTOR_EDIT_LD) INSTRUCTOR_EDIT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(D.OEE_IND, S.OEE_IND, D.OEE_IND, S.OEE_IND) OEE_IND,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       decode(D.RQMNT_DESIGNTN, S.RQMNT_DESIGNTN, D.RQMNT_DESIGNTN, S.RQMNT_DESIGNTN) RQMNT_DESIGNTN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.RQMNT_DESIGNTN_SD, S.RQMNT_DESIGNTN_SD, D.RQMNT_DESIGNTN_SD, S.RQMNT_DESIGNTN_SD) RQMNT_DESIGNTN_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.RQMNT_DESIGNTN_LD, S.RQMNT_DESIGNTN_LD, D.RQMNT_DESIGNTN_LD, S.RQMNT_DESIGNTN_LD) RQMNT_DESIGNTN_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.RQMNT_DESIGNTN_FD, S.RQMNT_DESIGNTN_FD, D.RQMNT_DESIGNTN_FD, S.RQMNT_DESIGNTN_FD) RQMNT_DESIGNTN_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.SBJCT_CD, S.SBJCT_CD, D.SBJCT_CD, S.SBJCT_CD) SBJCT_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.SBJCT_SD, S.SBJCT_SD, D.SBJCT_SD, S.SBJCT_SD) SBJCT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.SBJCT_LD, S.SBJCT_LD, D.SBJCT_LD, S.SBJCT_LD) SBJCT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.SBJCT_FD, S.SBJCT_FD, D.SBJCT_FD, S.SBJCT_FD) SBJCT_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.SBJCT_CD_DESC, S.SBJCT_CD_DESC, D.SBJCT_CD_DESC, S.SBJCT_CD_DESC) SBJCT_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       decode(D.SCHEDULE_CRSE_FLG, S.SCHEDULE_CRSE_FLG, D.SCHEDULE_CRSE_FLG, S.SCHEDULE_CRSE_FLG) SCHEDULE_CRSE_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.SCHEDULE_PRINT_FLG, S.SCHEDULE_PRINT_FLG, D.SCHEDULE_PRINT_FLG, S.SCHEDULE_PRINT_FLG) SCHEDULE_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(D.SCHED_PRINT_INSTR_FLG, S.SCHED_PRINT_INSTR_FLG, D.SCHED_PRINT_INSTR_FLG, S.SCHED_PRINT_INSTR_FLG) SCHED_PRINT_INSTR_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       decode(D.SCHED_TERM_ROLL_FLG, S.SCHED_TERM_ROLL_FLG, D.SCHED_TERM_ROLL_FLG, S.SCHED_TERM_ROLL_FLG) SCHED_TERM_ROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
       decode(D.SPLIT_OWNER, S.SPLIT_OWNER, D.SPLIT_OWNER, S.SPLIT_OWNER) SPLIT_OWNER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       decode(D.SEV_VALID_CIP_FLG, S.SEV_VALID_CIP_FLG, D.SEV_VALID_CIP_FLG, S.SEV_VALID_CIP_FLG) SEV_VALID_CIP_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       decode(D.UM_STEM_FLG, S.UM_STEM_FLG, D.UM_STEM_FLG, S.UM_STEM_FLG) UM_STEM_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       decode(D.ACAD_PRGRS_UNITS, S.ACAD_PRGRS_UNITS, D.ACAD_PRGRS_UNITS, S.ACAD_PRGRS_UNITS) ACAD_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(D.CRSE_CNT, S.CRSE_CNT, D.CRSE_CNT, S.CRSE_CNT) CRSE_CNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(D.CRSE_CONTACT_HRS, S.CRSE_CONTACT_HRS, D.CRSE_CONTACT_HRS, S.CRSE_CONTACT_HRS) CRSE_CONTACT_HRS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(D.FA_PRGRS_UNITS, S.FA_PRGRS_UNITS, D.FA_PRGRS_UNITS, S.FA_PRGRS_UNITS) FA_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(D.MIN_UNITS, S.MIN_UNITS, D.MIN_UNITS, S.MIN_UNITS) MIN_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       decode(D.MAX_UNITS, S.MAX_UNITS, D.MAX_UNITS, S.MAX_UNITS) MAX_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       decode(D.UNITS_REPEAT_LIMIT, S.UNITS_REPEAT_LIMIT, D.UNITS_REPEAT_LIMIT, S.UNITS_REPEAT_LIMIT) UNITS_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(D.DATA_ORIGIN, S.DATA_ORIGIN, D.DATA_ORIGIN, S.DATA_ORIGIN) DATA_ORIGIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       nvl(D.CREATED_EW_DTTM, SYSDATE) CREATED_EW_DTTM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       nvl(D.LASTUPD_EW_DTTM, SYSDATE) LASTUPD_EW_DTTM,
decode(D.DESCRLONG,S.DESCRLONG,D.DESCRLONG,S.DESCRLONG) DESCRLONG	   
  from S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
  left outer join CSMRT_OWNER.UM_D_CRSE D                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
    on D.CRSE_SID <> 2147483646                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
   and D.CRSE_CD = S.CRSE_CD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
   and D.CRSE_OFFER_NUM = S.CRSE_OFFER_NUM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
   and D.SRC_SYS_ID = S.SRC_SYS_ID                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
) S                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
    on  (T.CRSE_CD = S.CRSE_CD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
   and  T.CRSE_OFFER_NUM = S.CRSE_OFFER_NUM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
   and  T.SRC_SYS_ID = S.SRC_SYS_ID)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
 when matched then update set                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.EFFDT = S.EFFDT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.EFF_STATUS = S.EFF_STATUS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.CRSE_SD = S.CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.CRSE_LD = S.CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.CRSE_CD_DESC = S.CRSE_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.CRSE_TTL_LD = S.CRSE_TTL_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.INSTITUTION_CD = S.INSTITUTION_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.INSTITUTION_SID = S.INSTITUTION_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.ACAD_CAR_SID = S.ACAD_CAR_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.ACAD_GRP_SID = S.ACAD_GRP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.ACAD_ORG_SID = S.ACAD_ORG_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.CAMPUS_SID = S.CAMPUS_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.RQRMNT_GROUP_SID = S.RQRMNT_GROUP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SSR_COMP_SID = S.SSR_COMP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.SSR_COMP_PRIM_SID = S.SSR_COMP_PRIM_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.ALLOW_MULT_ENROLL_FLG = S.ALLOW_MULT_ENROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.BLIND_GRADING_FLG = S.BLIND_GRADING_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CATALOG_NUM = S.CATALOG_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.CATALOG_PRINT_FLG = S.CATALOG_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CIP_CD = S.CIP_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.CIP_LD = S.CIP_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.CONSENT = S.CONSENT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.CONSENT_SD = S.CONSENT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.CONSENT_LD = S.CONSENT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.CRSE_APPRV_CD = S.CRSE_APPRV_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.CRSE_APPRV_SD = S.CRSE_APPRV_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.CRSE_APPRV_LD = S.CRSE_APPRV_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.CRSE_DISPLAY_NAME = S.CRSE_DISPLAY_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CRSE_LVL = S.CRSE_LVL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.CRSE_REPEAT_FLG = S.CRSE_REPEAT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.CRSE_REPEAT_LIMIT = S.CRSE_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.EQUIV_CRSE_ID = S.EQUIV_CRSE_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.EQUIV_CRSE_SD = S.EQUIV_CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.EQUIV_CRSE_LD = S.EQUIV_CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.FEES_EXIST_FLG = S.FEES_EXIST_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.GRADE_BASIS_CD = S.GRADE_BASIS_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.GRADE_BASIS_SD = S.GRADE_BASIS_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.GRADE_BASIS_LD = S.GRADE_BASIS_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.GRADE_ROSTER_PRINT = S.GRADE_ROSTER_PRINT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.GRADE_ROSTER_PRINT_SD = S.GRADE_ROSTER_PRINT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.GRADE_ROSTER_PRINT_LD = S.GRADE_ROSTER_PRINT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.INSTRUCTOR_EDIT = S.INSTRUCTOR_EDIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.INSTRUCTOR_EDIT_SD = S.INSTRUCTOR_EDIT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.INSTRUCTOR_EDIT_LD = S.INSTRUCTOR_EDIT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.OEE_IND = S.OEE_IND,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.RQMNT_DESIGNTN = S.RQMNT_DESIGNTN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.RQMNT_DESIGNTN_SD = S.RQMNT_DESIGNTN_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.RQMNT_DESIGNTN_LD = S.RQMNT_DESIGNTN_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.RQMNT_DESIGNTN_FD = S.RQMNT_DESIGNTN_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.SBJCT_CD = S.SBJCT_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SBJCT_SD = S.SBJCT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SBJCT_LD = S.SBJCT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SBJCT_FD = S.SBJCT_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SBJCT_CD_DESC = S.SBJCT_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.SCHEDULE_CRSE_FLG = S.SCHEDULE_CRSE_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.SCHEDULE_PRINT_FLG = S.SCHEDULE_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.SCHED_PRINT_INSTR_FLG = S.SCHED_PRINT_INSTR_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.SCHED_TERM_ROLL_FLG = S.SCHED_TERM_ROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.SPLIT_OWNER = S.SPLIT_OWNER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.SEV_VALID_CIP_FLG = S.SEV_VALID_CIP_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.UM_STEM_FLG = S.UM_STEM_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.ACAD_PRGRS_UNITS = S.ACAD_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.CRSE_CNT = S.CRSE_CNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.CRSE_CONTACT_HRS = S.CRSE_CONTACT_HRS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.FA_PRGRS_UNITS = S.FA_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.MIN_UNITS = S.MIN_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.MAX_UNITS = S.MAX_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.UNITS_REPEAT_LIMIT = S.UNITS_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.DATA_ORIGIN = S.DATA_ORIGIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.LASTUPD_EW_DTTM = SYSDATE,
       T.DESCRLONG = S.DESCRLONG	   
 where                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       decode(T.EFFDT,S.EFFDT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.EFF_STATUS,S.EFF_STATUS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.CRSE_SD,S.CRSE_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.CRSE_LD,S.CRSE_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.CRSE_CD_DESC,S.CRSE_CD_DESC,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(T.CRSE_TTL_LD,S.CRSE_TTL_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(T.INSTITUTION_CD,S.INSTITUTION_CD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.INSTITUTION_SID,S.INSTITUTION_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.ACAD_CAR_SID,S.ACAD_CAR_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(T.ACAD_GRP_SID,S.ACAD_GRP_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(T.ACAD_ORG_SID,S.ACAD_ORG_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(T.CAMPUS_SID,S.CAMPUS_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.RQRMNT_GROUP_SID,S.RQRMNT_GROUP_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.SSR_COMP_SID,S.SSR_COMP_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       decode(T.SSR_COMP_PRIM_SID,S.SSR_COMP_PRIM_SID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.ALLOW_MULT_ENROLL_FLG,S.ALLOW_MULT_ENROLL_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.BLIND_GRADING_FLG,S.BLIND_GRADING_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.CATALOG_NUM,S.CATALOG_NUM,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(T.CATALOG_PRINT_FLG,S.CATALOG_PRINT_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.CIP_CD,S.CIP_CD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.CIP_LD,S.CIP_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.CONSENT,S.CONSENT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.CONSENT_SD,S.CONSENT_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.CONSENT_LD,S.CONSENT_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.CRSE_APPRV_CD,S.CRSE_APPRV_CD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.CRSE_APPRV_SD,S.CRSE_APPRV_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.CRSE_APPRV_LD,S.CRSE_APPRV_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.CRSE_DISPLAY_NAME,S.CRSE_DISPLAY_NAME,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.CRSE_LVL,S.CRSE_LVL,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.CRSE_REPEAT_FLG,S.CRSE_REPEAT_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.CRSE_REPEAT_LIMIT,S.CRSE_REPEAT_LIMIT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.EQUIV_CRSE_ID,S.EQUIV_CRSE_ID,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.EQUIV_CRSE_SD,S.EQUIV_CRSE_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.EQUIV_CRSE_LD,S.EQUIV_CRSE_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.FEES_EXIST_FLG,S.FEES_EXIST_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.GRADE_BASIS_CD,S.GRADE_BASIS_CD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.GRADE_BASIS_SD,S.GRADE_BASIS_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.GRADE_BASIS_LD,S.GRADE_BASIS_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.GRADE_ROSTER_PRINT,S.GRADE_ROSTER_PRINT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.GRADE_ROSTER_PRINT_SD,S.GRADE_ROSTER_PRINT_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.GRADE_ROSTER_PRINT_LD,S.GRADE_ROSTER_PRINT_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.INSTRUCTOR_EDIT,S.INSTRUCTOR_EDIT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.INSTRUCTOR_EDIT_SD,S.INSTRUCTOR_EDIT_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.INSTRUCTOR_EDIT_LD,S.INSTRUCTOR_EDIT_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.OEE_IND,S.OEE_IND,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       decode(T.RQMNT_DESIGNTN,S.RQMNT_DESIGNTN,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.RQMNT_DESIGNTN_SD,S.RQMNT_DESIGNTN_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.RQMNT_DESIGNTN_LD,S.RQMNT_DESIGNTN_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.RQMNT_DESIGNTN_FD,S.RQMNT_DESIGNTN_FD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.SBJCT_CD,S.SBJCT_CD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.SBJCT_SD,S.SBJCT_SD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.SBJCT_LD,S.SBJCT_LD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.SBJCT_FD,S.SBJCT_FD,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.SBJCT_CD_DESC,S.SBJCT_CD_DESC,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.SCHEDULE_CRSE_FLG,S.SCHEDULE_CRSE_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.SCHEDULE_PRINT_FLG,S.SCHEDULE_PRINT_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.SCHED_PRINT_INSTR_FLG,S.SCHED_PRINT_INSTR_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       decode(T.SCHED_TERM_ROLL_FLG,S.SCHED_TERM_ROLL_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(T.SPLIT_OWNER,S.SPLIT_OWNER,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(T.SEV_VALID_CIP_FLG,S.SEV_VALID_CIP_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.UM_STEM_FLG,S.UM_STEM_FLG,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       decode(T.ACAD_PRGRS_UNITS,S.ACAD_PRGRS_UNITS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.CRSE_CNT,S.CRSE_CNT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.CRSE_CONTACT_HRS,S.CRSE_CONTACT_HRS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       decode(T.FA_PRGRS_UNITS,S.FA_PRGRS_UNITS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       decode(T.MIN_UNITS,S.MIN_UNITS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.MAX_UNITS,S.MAX_UNITS,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       decode(T.UNITS_REPEAT_LIMIT,S.UNITS_REPEAT_LIMIT,0,1) = 1 or                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       decode(T.DATA_ORIGIN,S.DATA_ORIGIN,0,1) = 1 or
       decode(T.DESCRLONG,S.DESCRLONG,0,1) = 1 	   
  when not matched then                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
insert (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.CRSE_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.CRSE_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CRSE_OFFER_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.SRC_SYS_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       T.EFFDT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.EFF_STATUS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       T.CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CRSE_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       T.CRSE_TTL_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.INSTITUTION_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.INSTITUTION_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.ACAD_CAR_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       T.ACAD_GRP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       T.ACAD_ORG_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       T.CAMPUS_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       T.RQRMNT_GROUP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       T.SSR_COMP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       T.SSR_COMP_PRIM_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.ALLOW_MULT_ENROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.BLIND_GRADING_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.CATALOG_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.CATALOG_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.CIP_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       T.CIP_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       T.CONSENT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.CONSENT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       T.CONSENT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       T.CRSE_APPRV_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.CRSE_APPRV_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.CRSE_APPRV_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.CRSE_DISPLAY_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.CRSE_LVL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.CRSE_REPEAT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.CRSE_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.EQUIV_CRSE_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.EQUIV_CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.EQUIV_CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.FEES_EXIST_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.GRADE_BASIS_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.GRADE_BASIS_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.GRADE_BASIS_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.GRADE_ROSTER_PRINT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       T.GRADE_ROSTER_PRINT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.GRADE_ROSTER_PRINT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.INSTRUCTOR_EDIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.INSTRUCTOR_EDIT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       T.INSTRUCTOR_EDIT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       T.OEE_IND,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       T.RQMNT_DESIGNTN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.RQMNT_DESIGNTN_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.RQMNT_DESIGNTN_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.RQMNT_DESIGNTN_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.SBJCT_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.SBJCT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.SBJCT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.SBJCT_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.SBJCT_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       T.SCHEDULE_CRSE_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.SCHEDULE_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       T.SCHED_PRINT_INSTR_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       T.SCHED_TERM_ROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       T.SPLIT_OWNER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.SEV_VALID_CIP_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       T.UM_STEM_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.ACAD_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       T.CRSE_CNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       T.CRSE_CONTACT_HRS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       T.FA_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       T.MIN_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.MAX_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       T.UNITS_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       T.DATA_ORIGIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       T.CREATED_EW_DTTM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.LASTUPD_EW_DTTM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       T.DESCRLONG)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
values (                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.CRSE_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.CRSE_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       S.CRSE_OFFER_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.SRC_SYS_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       S.EFFDT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       S.EFF_STATUS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       S.CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       S.CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       S.CRSE_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       S.CRSE_TTL_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       S.INSTITUTION_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.INSTITUTION_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       S.ACAD_CAR_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       S.ACAD_GRP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       S.ACAD_ORG_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       S.CAMPUS_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       S.RQRMNT_GROUP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       S.SSR_COMP_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
       S.SSR_COMP_PRIM_SID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.ALLOW_MULT_ENROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       S.BLIND_GRADING_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.CATALOG_NUM,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       S.CATALOG_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.CIP_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       S.CIP_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       S.CONSENT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       S.CONSENT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       S.CONSENT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
       S.CRSE_APPRV_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.CRSE_APPRV_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.CRSE_APPRV_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.CRSE_DISPLAY_NAME,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.CRSE_LVL,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.CRSE_REPEAT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       S.CRSE_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.EQUIV_CRSE_ID,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.EQUIV_CRSE_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.EQUIV_CRSE_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.FEES_EXIST_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.GRADE_BASIS_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.GRADE_BASIS_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.GRADE_BASIS_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.GRADE_ROSTER_PRINT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       S.GRADE_ROSTER_PRINT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       S.GRADE_ROSTER_PRINT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       S.INSTRUCTOR_EDIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
       S.INSTRUCTOR_EDIT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       S.INSTRUCTOR_EDIT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       S.OEE_IND,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
       S.RQMNT_DESIGNTN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.RQMNT_DESIGNTN_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.RQMNT_DESIGNTN_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.RQMNT_DESIGNTN_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.SBJCT_CD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.SBJCT_SD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.SBJCT_LD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.SBJCT_FD,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.SBJCT_CD_DESC,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
       S.SCHEDULE_CRSE_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.SCHEDULE_PRINT_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       S.SCHED_PRINT_INSTR_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       S.SCHED_TERM_ROLL_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
       S.SPLIT_OWNER,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       S.SEV_VALID_CIP_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
       S.UM_STEM_FLG,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       S.ACAD_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       S.CRSE_CNT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
       S.CRSE_CONTACT_HRS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
       S.FA_PRGRS_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
       S.MIN_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       S.MAX_UNITS,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
       S.UNITS_REPEAT_LIMIT,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
       S.DATA_ORIGIN,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
       SYSDATE,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
       SYSDATE,
	   S.DESCRLONG);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

strSqlCommand   := 'SET intRowCount';
intRowCount     := SQL%ROWCOUNT;

strSqlCommand := 'commit';
commit;

strMessage01    := '# of UM_D_CRSE rows merged: ' || TO_CHAR(intRowCount,'999,999,999,999');
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_DETAIL';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_DETAIL
        (
                i_TargetTableName   => 'UM_D_CRSE',
                i_Action            => 'MERGE',
                i_RowCount          => intRowCount
        );

strMessage01    := 'Updating DATA_ORIGIN on CSMRT_OWNER.UM_D_CRSE';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand   := 'update DATA_ORIGIN on CSMRT_OWNER.UM_D_CRSE';
update CSMRT_OWNER.UM_D_CRSE T  
   set DATA_ORIGIN = 'D',
       LASTUPD_EW_DTTM = sysdate
 where DATA_ORIGIN <> 'D'
   and T.CRSE_SID <> 2147483646
   and not exists (select 1
                     from CSSTG_OWNER.PS_CRSE_CATALOG S
                    where T.CRSE_CD = S.CRSE_ID
                      and T.SRC_SYS_ID = S.SRC_SYS_ID
                      and S.DATA_ORIGIN <> 'D')
;

strSqlCommand   := 'SET intRowCount';
intRowCount     := SQL%ROWCOUNT;

strSqlCommand := 'commit';
commit;

strMessage01    := '# of UM_D_CRSE rows updated: ' || TO_CHAR(intRowCount,'999,999,999,999');
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_DETAIL';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_DETAIL
        (
                i_TargetTableName   => 'UM_D_CRSE',
                i_Action            => 'UPDATE',
                i_RowCount          => intRowCount
        );

strSqlCommand   := 'update DATA_ORIGIN on CSMRT_OWNER.UM_D_CRSE';
update CSMRT_OWNER.UM_D_CRSE T  
   set DATA_ORIGIN = 'D',
       LASTUPD_EW_DTTM = SYSDATE
 where DATA_ORIGIN <> 'D'
   and T.CRSE_SID <> 2147483646
   and not exists (select 1
                     from CSSTG_OWNER.PS_CRSE_OFFER S
                    where T.CRSE_CD = S.CRSE_ID
                      and T.CRSE_OFFER_NUM = S.CRSE_OFFER_NBR
                      and T.EFFDT = S.EFFDT
                      and T.SRC_SYS_ID = S.SRC_SYS_ID
                      and S.DATA_ORIGIN <> 'D')
;

strSqlCommand   := 'SET intRowCount';
intRowCount     := SQL%ROWCOUNT;

strSqlCommand := 'commit';
commit;

strMessage01    := '# of UM_D_CRSE rows updated: ' || TO_CHAR(intRowCount,'999,999,999,999');
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_DETAIL';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_DETAIL
        (
                i_TargetTableName   => 'UM_D_CRSE',
                i_Action            => 'UPDATE',
                i_RowCount          => intRowCount
        );

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_SUCCESS';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_SUCCESS;

strMessage01    := strProcessName || ' is complete.';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

EXCEPTION
    WHEN OTHERS THEN
        COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_EXCEPTION
                (
                        i_SqlCommand   => strSqlCommand,
                        i_SqlCode      => SQLCODE,
                        i_SqlErrm      => SQLERRM
                );

END UM_D_CRSE_P;
/
