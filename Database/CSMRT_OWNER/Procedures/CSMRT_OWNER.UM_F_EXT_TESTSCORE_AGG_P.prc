CREATE OR REPLACE PROCEDURE             "UM_F_EXT_TESTSCORE_AGG_P" AUTHID CURRENT_USER IS

------------------------------------------------------------------------
--George Adams
--Loads table                -- UM_F_EXT_TESTSCORE_AGG
--V01 12/11/2018             -- srikanth ,pabbu converted to proc from sql scripts

------------------------------------------------------------------------

        strMartId                       Varchar2(50)    := 'CSW';
        strProcessName                  Varchar2(100)   := 'UM_F_EXT_TESTSCORE_AGG';
        intProcessSid                   Integer;
        dtProcessStart                  Date            := SYSDATE;
        strMessage01                    Varchar2(4000);
        strMessage02                    Varchar2(512);
        strMessage03                    Varchar2(512)   :='';
        strNewLine                      Varchar2(2)     := chr(13) || chr(10);
        strSqlCommand                   Varchar2(32767) :='';
        strSqlDynamic                   Varchar2(32767) :='';
        strClientInfo                   Varchar2(100);
        intRowCount                     Integer;
        intTotalRowCount                Integer         := 0;
        numSqlCode                      Number;
        strSqlErrm                      Varchar2(4000);
        intTries                        Integer;

BEGIN
strSqlCommand := 'DBMS_APPLICATION_INFO.SET_CLIENT_INFO';
DBMS_APPLICATION_INFO.SET_CLIENT_INFO (strProcessName);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_INIT';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_INIT
        (
                i_MartId                => strMartId,
                i_ProcessName           => strProcessName,
                i_ProcessStartTime      => dtProcessStart,
                o_ProcessSid            => intProcessSid
        );

strMessage01    := 'Disabling Indexes for table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);
COMMON_OWNER.SMT_INDEX.ALL_UNUSABLE('CSMRT_OWNER','UM_F_EXT_TESTSCORE_AGG');

strSqlDynamic   := 'alter table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG disable constraint PK_UM_F_EXT_TESTSCORE_AGG';
strSqlCommand   := 'SMT_UTILITY.EXECUTE_IMMEDIATE: ' || strSqlDynamic;
COMMON_OWNER.SMT_UTILITY.EXECUTE_IMMEDIATE
                (
                i_SqlStatement          => strSqlDynamic,
                i_MaxTries              => 10,
                i_WaitSeconds           => 10,
                o_Tries                 => intTries
                );
				
strMessage01    := 'Truncating table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlDynamic   := 'truncate table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';
strSqlCommand   := 'SMT_UTILITY.EXECUTE_IMMEDIATE: ' || strSqlDynamic;
COMMON_OWNER.SMT_UTILITY.EXECUTE_IMMEDIATE
                (
                i_SqlStatement          => strSqlDynamic,
                i_MaxTries              => 10,
                i_WaitSeconds           => 10,
                o_Tries                 => intTries
                );

strMessage01    := 'Inserting data into CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand   := 'insert into CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';				
insert /*+ append */ into UM_F_EXT_TESTSCORE_AGG 
with T0 as (
select /*+ INLINE PARALLEL(8) */
       PERSON_SID, SRC_SYS_ID, 
       PERSON_ID, TEST_ID, TEST_CMPNT_ID, TEST_CMPNT_ORDER, BEST_SCORE_FLG,
       NUMERIC_SCORE,
       row_number() over (partition by PERSON_SID, SRC_SYS_ID, TEST_CMPNT_ID
                              order by decode(TEST_ID,'SAT C',1,'SAT I',2,9), BEST_SCORE_FLG desc, TEST_CMPNT_ORDER) SAT_ORDER
  from UM_F_EXT_TESTSCORE
), 
T1 as (
select /*+ INLINE PARALLEL(8) */
PERSON_SID, 
SRC_SYS_ID, 
PERSON_ID, 
SUM(CASE WHEN TEST_ID = 'ACT' AND TEST_CMPNT_ID = 'COMP' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) ACT_COMP_SCORE,
SUM(CASE WHEN TEST_ID = 'ACT' AND TEST_CMPNT_ID = 'MATH' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) ACT_MATH_SCORE, 
SUM(CASE WHEN TEST_ID = 'ACT' AND TEST_CMPNT_ID = 'READ' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) ACT_VERB_SCORE, 
SUM(CASE WHEN TEST_ID = 'ACT' AND TEST_CMPNT_ID = 'WR' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) ACT_WR_SCORE, 
SUM(CASE WHEN TEST_ID = 'GMAT' AND TEST_CMPNT_ID = 'ANLY' 
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GMAT_ANLY_SCORE, 
SUM(CASE WHEN TEST_ID = 'GMAT' AND TEST_CMPNT_ID = 'IR' 
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GMAT_IR_SCORE,                                                  
SUM(CASE WHEN TEST_ID = 'GMAT' AND TEST_CMPNT_ID = 'QUAN' 
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GMAT_QUAN_SCORE, 
SUM(CASE WHEN TEST_ID = 'GMAT' AND TEST_CMPNT_ID = 'VERB' 
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GMAT_VERB_SCORE, 
SUM(CASE WHEN TEST_ID = 'GMAT' AND TEST_CMPNT_ID = 'TOTAL' 
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GMAT_TOTAL_SCORE, 
SUM(CASE WHEN TEST_ID = 'GRE' AND TEST_CMPNT_ID = 'QUANT' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GRE_QUAN_SCORE,
SUM(CASE WHEN TEST_ID = 'GRE' AND TEST_CMPNT_ID = 'VERBR'
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GRE_VERB_SCORE,
SUM(CASE WHEN TEST_ID = 'GRE' AND TEST_CMPNT_ID = 'WR' 
                              AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) GRE_WR_SCORE,
SUM(CASE WHEN TEST_ID = 'IELTS' AND TEST_CMPNT_ID = 'BAND'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) IELTS_BAND_SCORE,
SUM(CASE WHEN TEST_ID = 'LSAT' AND TEST_CMPNT_ID = 'COMP'
                               AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) LSAT_COMP_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'AHSSC'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_AHSSC_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'ASC'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_ASC_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'CE'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_CE_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'EI'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_EI_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'ERWS'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_ERWS_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'ESA'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_ESA_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'ESR'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_ESR_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'ESW'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_ESW_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT C' AND TEST_CMPNT_ID = 'MATH'
                                AND TEST_CMPNT_ORDER = 1 
                                AND BEST_SCORE_FLG = 'Y'
                                AND SAT_ORDER = 1           -- Nov 2016 
         THEN NUMERIC_SCORE
         WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'MATH'
                                AND TEST_CMPNT_ORDER = 1 
                                AND BEST_SCORE_FLG = 'Y'
                                AND SAT_ORDER = 1           -- Nov 2016 
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_MATH_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'HA'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_HA_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'MSS'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_MSS_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'MT'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_MT_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'PAM'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_PAM_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'PSDA'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_PSDA_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'RT'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_RT_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'RWC'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_RWC_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'SEC'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_SEC_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'TOTAL'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_TOTAL_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT C' AND TEST_CMPNT_ID = 'VERB'
                                AND TEST_CMPNT_ORDER = 1 
                                AND BEST_SCORE_FLG = 'Y'  
                                AND SAT_ORDER = 1           -- Nov 2016 
         THEN NUMERIC_SCORE
         WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'VERB'
                                AND TEST_CMPNT_ORDER = 1 
                                AND BEST_SCORE_FLG = 'Y'
                                AND SAT_ORDER = 1           -- Nov 2016 
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_VERB_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'WLT'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_WLT_SCORE,
SUM(CASE WHEN TEST_ID = 'SAT I' AND TEST_CMPNT_ID = 'WR'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) SAT_WR_SCORE,
SUM(CASE WHEN TEST_ID = 'TOEFL' AND TEST_CMPNT_ID = 'IBTT'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) TOEFL_IBTT_SCORE, 
SUM(CASE WHEN TEST_ID = 'TOEFL' AND TEST_CMPNT_ID = 'COMPP'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) TOEFL_COMPP_SCORE,
SUM(CASE WHEN TEST_ID = 'DAEVL' AND TEST_CMPNT_ID = 'COMP'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y'
         THEN NUMERIC_SCORE
         ELSE NULL END) UMDAR_INDEX_SCORE,
SUM(CASE WHEN TEST_ID = 'LINDX' AND TEST_CMPNT_ID = 'INDX'
                                AND TEST_CMPNT_ORDER = 1 AND BEST_SCORE_FLG = 'Y' 
         THEN NUMERIC_SCORE
         ELSE NULL END) UMLOW_INDEX_SCORE
  from T0
 group by PERSON_SID, SRC_SYS_ID, PERSON_ID)
select    PERSON_SID,
          SRC_SYS_ID,
          PERSON_ID, 
          ACT_COMP_SCORE, 
          ACT_MATH_SCORE, 
          ACT_VERB_SCORE, 
          ACT_WR_SCORE, 
          CASE
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 400 AND 400
             THEN
                9
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 401 AND 440
             THEN
                10
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 441 AND 500
             THEN
                11
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 501 AND 560
             THEN
                12
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 561 AND 620
             THEN
                13
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 621 AND 690
             THEN
                14
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 691 AND 740
             THEN
                15
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 741 AND 790
             THEN
                16
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 791 AND 830
             THEN
                17
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 831 AND 880
             THEN
                18
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 881 AND 920
             THEN
                19
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 921 AND 960
             THEN
                20
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 961 AND 1000
             THEN
                21
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1001 AND 1040
             THEN
                22
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1041 AND 1080
             THEN
                23
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1081 AND 1110
             THEN
                24
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1111 AND 1150
             THEN
                25
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1151 AND 1190
             THEN
                26
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1191 AND 1220
             THEN
                27
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1221 AND 1260
             THEN
                28
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1261 AND 1300
             THEN
                29
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1301 AND 1340
             THEN
                30
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1341 AND 1380
             THEN
                31
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1381 AND 1440
             THEN
                32
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1441 AND 1500
             THEN
                33
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1501 AND 1560
             THEN
                34
             WHEN SAT_MATH_SCORE + SAT_VERB_SCORE BETWEEN 1561 AND 1600
             THEN
                35
             ELSE
                NULL
          END
             ACT_CONV_SCORE,
          GMAT_ANLY_SCORE, 
          GMAT_QUAN_SCORE, 
          GMAT_VERB_SCORE, 
          GMAT_IR_SCORE,   
          GMAT_TOTAL_SCORE,
          WIDTH_BUCKET ( (GRE_QUAN_SCORE + GRE_VERB_SCORE),400,1601,10) GRE_COMB_DECILE,
          GRE_WR_SCORE GRE_ANLY_SCORE, 
          GRE_QUAN_SCORE,
          GRE_VERB_SCORE,
          IELTS_BAND_SCORE, 
          LSAT_COMP_SCORE,
          SAT_AHSSC_SCORE,     -- Sept 2016  
          SAT_ASC_SCORE,       -- Sept 2016 
          SAT_CE_SCORE,        -- Sept 2016 
          WIDTH_BUCKET ( (SAT_MATH_SCORE + SAT_VERB_SCORE),400,1601,10) SAT_COMB_DECILE,
          CASE
             WHEN ACT_COMP_SCORE <= 10 THEN NULL
             WHEN ACT_COMP_SCORE  = 11 THEN 530
             WHEN ACT_COMP_SCORE  = 12 THEN 590
             WHEN ACT_COMP_SCORE  = 13 THEN 640
             WHEN ACT_COMP_SCORE  = 14 THEN 690
             WHEN ACT_COMP_SCORE  = 15 THEN 740
             WHEN ACT_COMP_SCORE  = 16 THEN 790
             WHEN ACT_COMP_SCORE  = 17 THEN 830
             WHEN ACT_COMP_SCORE  = 18 THEN 870
             WHEN ACT_COMP_SCORE  = 19 THEN 910
             WHEN ACT_COMP_SCORE  = 20 THEN 950
             WHEN ACT_COMP_SCORE  = 21 THEN 990
             WHEN ACT_COMP_SCORE  = 22 THEN 1030
             WHEN ACT_COMP_SCORE  = 23 THEN 1070
             WHEN ACT_COMP_SCORE  = 24 THEN 1110
             WHEN ACT_COMP_SCORE  = 25 THEN 1150
             WHEN ACT_COMP_SCORE  = 26 THEN 1190
             WHEN ACT_COMP_SCORE  = 27 THEN 1220
             WHEN ACT_COMP_SCORE  = 28 THEN 1260
             WHEN ACT_COMP_SCORE  = 29 THEN 1300
             WHEN ACT_COMP_SCORE  = 30 THEN 1340
             WHEN ACT_COMP_SCORE  = 31 THEN 1380
             WHEN ACT_COMP_SCORE  = 32 THEN 1420
             WHEN ACT_COMP_SCORE  = 33 THEN 1460
             WHEN ACT_COMP_SCORE  = 34 THEN 1510
             WHEN ACT_COMP_SCORE  = 35 THEN 1560
             WHEN ACT_COMP_SCORE  = 36 THEN 1600
             ELSE NULL
          END
             SAT_CONV_SCORE, 
          CASE
             WHEN ACT_COMP_SCORE <= 10 THEN NULL
             WHEN ACT_COMP_SCORE  = 11 THEN 590
             WHEN ACT_COMP_SCORE  = 12 THEN 680
             WHEN ACT_COMP_SCORE  = 13 THEN 740
             WHEN ACT_COMP_SCORE  = 14 THEN 780
             WHEN ACT_COMP_SCORE  = 15 THEN 830
             WHEN ACT_COMP_SCORE  = 16 THEN 870
             WHEN ACT_COMP_SCORE  = 17 THEN 910
             WHEN ACT_COMP_SCORE  = 18 THEN 950
             WHEN ACT_COMP_SCORE  = 19 THEN 990
             WHEN ACT_COMP_SCORE  = 20 THEN 1030
             WHEN ACT_COMP_SCORE  = 21 THEN 1070
             WHEN ACT_COMP_SCORE  = 22 THEN 1110
             WHEN ACT_COMP_SCORE  = 23 THEN 1140
             WHEN ACT_COMP_SCORE  = 24 THEN 1180
             WHEN ACT_COMP_SCORE  = 25 THEN 1220
             WHEN ACT_COMP_SCORE  = 26 THEN 1260
             WHEN ACT_COMP_SCORE  = 27 THEN 1290
             WHEN ACT_COMP_SCORE  = 28 THEN 1320
             WHEN ACT_COMP_SCORE  = 29 THEN 1360
             WHEN ACT_COMP_SCORE  = 30 THEN 1400
             WHEN ACT_COMP_SCORE  = 31 THEN 1430
             WHEN ACT_COMP_SCORE  = 32 THEN 1470
             WHEN ACT_COMP_SCORE  = 33 THEN 1500
             WHEN ACT_COMP_SCORE  = 34 THEN 1540
             WHEN ACT_COMP_SCORE  = 35 THEN 1570
             WHEN ACT_COMP_SCORE  = 36 THEN 1600
             ELSE NULL
          END SAT_CONV_2016_SCORE,   				-- Oct 2016  
          CASE
             WHEN ACT_COMP_SCORE <= 10 THEN NULL
             WHEN ACT_COMP_SCORE  = 11 THEN 670
             WHEN ACT_COMP_SCORE  = 12 THEN 710
             WHEN ACT_COMP_SCORE  = 13 THEN 760
             WHEN ACT_COMP_SCORE  = 14 THEN 800
             WHEN ACT_COMP_SCORE  = 15 THEN 850
             WHEN ACT_COMP_SCORE  = 16 THEN 890
             WHEN ACT_COMP_SCORE  = 17 THEN 930
             WHEN ACT_COMP_SCORE  = 18 THEN 970
             WHEN ACT_COMP_SCORE  = 19 THEN 1010
             WHEN ACT_COMP_SCORE  = 20 THEN 1040
             WHEN ACT_COMP_SCORE  = 21 THEN 1080
             WHEN ACT_COMP_SCORE  = 22 THEN 1110
             WHEN ACT_COMP_SCORE  = 23 THEN 1140
             WHEN ACT_COMP_SCORE  = 24 THEN 1180
             WHEN ACT_COMP_SCORE  = 25 THEN 1210
             WHEN ACT_COMP_SCORE  = 26 THEN 1240
             WHEN ACT_COMP_SCORE  = 27 THEN 1280
             WHEN ACT_COMP_SCORE  = 28 THEN 1310
             WHEN ACT_COMP_SCORE  = 29 THEN 1340
             WHEN ACT_COMP_SCORE  = 30 THEN 1370
             WHEN ACT_COMP_SCORE  = 31 THEN 1400
             WHEN ACT_COMP_SCORE  = 32 THEN 1430
             WHEN ACT_COMP_SCORE  = 33 THEN 1460
             WHEN ACT_COMP_SCORE  = 34 THEN 1500
             WHEN ACT_COMP_SCORE  = 35 THEN 1540
             WHEN ACT_COMP_SCORE  = 36 THEN 1590
             ELSE NULL
          END SAT_CONV_2018_SCORE,   				-- Dec 2018  
SAT_EI_SCORE,                						-- Sept 2016 
SAT_ERWS_SCORE, 
CASE 
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 400 THEN 200
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 410 THEN 210
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 420 THEN 220
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 430 THEN 230
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 440 THEN 240
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 450 THEN 260
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 460 THEN 270
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 470 THEN 280
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 480 THEN 290
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 490 THEN 300
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 500 THEN 310
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 510 THEN 310
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 520 THEN 320
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 530 THEN 320
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 540 THEN 330
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 550 THEN 330
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 560 THEN 330
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 570 THEN 340
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 580 THEN 340
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 590 THEN 350
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 600 THEN 350
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 610 THEN 360
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 620 THEN 360
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 630 THEN 360
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 640 THEN 370
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 650 THEN 370
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 660 THEN 380
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 670 THEN 380
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 680 THEN 390
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 690 THEN 390
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 700 THEN 400
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 710 THEN 400
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 720 THEN 410
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 730 THEN 410
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 740 THEN 420
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 750 THEN 420
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 760 THEN 430
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 770 THEN 430
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 780 THEN 440
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 790 THEN 440
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 800 THEN 450
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 810 THEN 450
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 820 THEN 460
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 830 THEN 460
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 840 THEN 470
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 850 THEN 480
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 860 THEN 480
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 870 THEN 490
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 880 THEN 490
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 890 THEN 500
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 900 THEN 500
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 910 THEN 510
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 920 THEN 510
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 930 THEN 520
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 940 THEN 530
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 950 THEN 530
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 960 THEN 540
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 970 THEN 540
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 980 THEN 550
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 990 THEN 550
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1000 THEN 560
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1010 THEN 560
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1020 THEN 570
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1030 THEN 570
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1040 THEN 580
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1050 THEN 580
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1060 THEN 590
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1070 THEN 590
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1080 THEN 600
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1090 THEN 600
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1100 THEN 610
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1110 THEN 610
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1120 THEN 620
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1130 THEN 620
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1140 THEN 630
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1150 THEN 630
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1160 THEN 640
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1170 THEN 640
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1180 THEN 650
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1190 THEN 650
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1200 THEN 650
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1210 THEN 660
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1220 THEN 660
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1230 THEN 670
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1240 THEN 670
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1250 THEN 680
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1260 THEN 680
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1270 THEN 680
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1280 THEN 690
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1290 THEN 690
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1300 THEN 700
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1310 THEN 700
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1320 THEN 700
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1330 THEN 710
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1340 THEN 710
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1350 THEN 710
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1360 THEN 720
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1370 THEN 720
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1380 THEN 730
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1390 THEN 730
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1400 THEN 730
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1410 THEN 740
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1420 THEN 740
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1430 THEN 740
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1440 THEN 750
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1450 THEN 750
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1460 THEN 750
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1470 THEN 760
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1480 THEN 760
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1490 THEN 760
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1500 THEN 770
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1510 THEN 770
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1520 THEN 770
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1530 THEN 780
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1540 THEN 780
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1550 THEN 780
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1560 THEN 790
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1570 THEN 790
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1580 THEN 800
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1590 THEN 800
WHEN SAT_VERB_SCORE + SAT_WR_SCORE = 1600 THEN 800 
ELSE NULL
END SAT_ERWS_CONV_SCORE,      -- Added Sept 2016 
       SAT_ESA_SCORE,       -- Sept 2016 
       SAT_ESR_SCORE,       -- Sept 2016 
       SAT_ESW_SCORE,       -- Sept 2016 
       SAT_HA_SCORE,        -- Sept 2016 
       SAT_MATH_SCORE, 
       SAT_MSS_SCORE,
CASE 
WHEN SAT_MATH_SCORE = 200 THEN 200
WHEN SAT_MATH_SCORE = 210 THEN 220
WHEN SAT_MATH_SCORE = 220 THEN 230
WHEN SAT_MATH_SCORE = 230 THEN 250
WHEN SAT_MATH_SCORE = 240 THEN 260
WHEN SAT_MATH_SCORE = 250 THEN 280
WHEN SAT_MATH_SCORE = 260 THEN 300
WHEN SAT_MATH_SCORE = 270 THEN 310
WHEN SAT_MATH_SCORE = 280 THEN 330
WHEN SAT_MATH_SCORE = 290 THEN 340
WHEN SAT_MATH_SCORE = 300 THEN 350
WHEN SAT_MATH_SCORE = 310 THEN 360
WHEN SAT_MATH_SCORE = 320 THEN 360
WHEN SAT_MATH_SCORE = 330 THEN 370
WHEN SAT_MATH_SCORE = 340 THEN 380
WHEN SAT_MATH_SCORE = 350 THEN 390
WHEN SAT_MATH_SCORE = 360 THEN 400
WHEN SAT_MATH_SCORE = 370 THEN 410
WHEN SAT_MATH_SCORE = 380 THEN 420
WHEN SAT_MATH_SCORE = 390 THEN 430
WHEN SAT_MATH_SCORE = 400 THEN 440
WHEN SAT_MATH_SCORE = 410 THEN 450
WHEN SAT_MATH_SCORE = 420 THEN 460
WHEN SAT_MATH_SCORE = 430 THEN 470
WHEN SAT_MATH_SCORE = 440 THEN 480
WHEN SAT_MATH_SCORE = 450 THEN 490
WHEN SAT_MATH_SCORE = 460 THEN 500
WHEN SAT_MATH_SCORE = 470 THEN 510
WHEN SAT_MATH_SCORE = 480 THEN 510
WHEN SAT_MATH_SCORE = 490 THEN 520
WHEN SAT_MATH_SCORE = 500 THEN 530
WHEN SAT_MATH_SCORE = 510 THEN 540
WHEN SAT_MATH_SCORE = 520 THEN 550
WHEN SAT_MATH_SCORE = 530 THEN 560
WHEN SAT_MATH_SCORE = 540 THEN 570
WHEN SAT_MATH_SCORE = 550 THEN 570
WHEN SAT_MATH_SCORE = 560 THEN 580
WHEN SAT_MATH_SCORE = 570 THEN 590
WHEN SAT_MATH_SCORE = 580 THEN 600
WHEN SAT_MATH_SCORE = 590 THEN 610
WHEN SAT_MATH_SCORE = 600 THEN 620
WHEN SAT_MATH_SCORE = 610 THEN 630
WHEN SAT_MATH_SCORE = 620 THEN 640
WHEN SAT_MATH_SCORE = 630 THEN 650
WHEN SAT_MATH_SCORE = 640 THEN 660
WHEN SAT_MATH_SCORE = 650 THEN 670
WHEN SAT_MATH_SCORE = 660 THEN 690
WHEN SAT_MATH_SCORE = 670 THEN 700
WHEN SAT_MATH_SCORE = 680 THEN 710
WHEN SAT_MATH_SCORE = 690 THEN 720
WHEN SAT_MATH_SCORE = 700 THEN 730
WHEN SAT_MATH_SCORE = 710 THEN 740
WHEN SAT_MATH_SCORE = 720 THEN 750
WHEN SAT_MATH_SCORE = 730 THEN 760
WHEN SAT_MATH_SCORE = 740 THEN 760
WHEN SAT_MATH_SCORE = 750 THEN 770
WHEN SAT_MATH_SCORE = 760 THEN 780
WHEN SAT_MATH_SCORE = 770 THEN 780
WHEN SAT_MATH_SCORE = 780 THEN 790
WHEN SAT_MATH_SCORE = 790 THEN 800
WHEN SAT_MATH_SCORE = 800 THEN 800 
ELSE NULL
END SAT_MSS_CONV_SCORE,      -- Added Sept 2016 
       SAT_MT_SCORE,
CASE 
WHEN SAT_MATH_SCORE = 200 THEN 10
WHEN SAT_MATH_SCORE = 210 THEN 11
WHEN SAT_MATH_SCORE = 220 THEN 11.5
WHEN SAT_MATH_SCORE = 230 THEN 12.5
WHEN SAT_MATH_SCORE = 240 THEN 13
WHEN SAT_MATH_SCORE = 250 THEN 14
WHEN SAT_MATH_SCORE = 260 THEN 15
WHEN SAT_MATH_SCORE = 270 THEN 15.5
WHEN SAT_MATH_SCORE = 280 THEN 16.5
WHEN SAT_MATH_SCORE = 290 THEN 17
WHEN SAT_MATH_SCORE = 300 THEN 17.5
WHEN SAT_MATH_SCORE = 310 THEN 18
WHEN SAT_MATH_SCORE = 320 THEN 18
WHEN SAT_MATH_SCORE = 330 THEN 18.5
WHEN SAT_MATH_SCORE = 340 THEN 19
WHEN SAT_MATH_SCORE = 350 THEN 19.5
WHEN SAT_MATH_SCORE = 360 THEN 20
WHEN SAT_MATH_SCORE = 370 THEN 20.5
WHEN SAT_MATH_SCORE = 380 THEN 21
WHEN SAT_MATH_SCORE = 390 THEN 21.5
WHEN SAT_MATH_SCORE = 400 THEN 22
WHEN SAT_MATH_SCORE = 410 THEN 22.5
WHEN SAT_MATH_SCORE = 420 THEN 23
WHEN SAT_MATH_SCORE = 430 THEN 23.5
WHEN SAT_MATH_SCORE = 440 THEN 24
WHEN SAT_MATH_SCORE = 450 THEN 24.5
WHEN SAT_MATH_SCORE = 460 THEN 25
WHEN SAT_MATH_SCORE = 470 THEN 25.5
WHEN SAT_MATH_SCORE = 480 THEN 25.5
WHEN SAT_MATH_SCORE = 490 THEN 26
WHEN SAT_MATH_SCORE = 500 THEN 26.5
WHEN SAT_MATH_SCORE = 510 THEN 27
WHEN SAT_MATH_SCORE = 520 THEN 27.5
WHEN SAT_MATH_SCORE = 530 THEN 28
WHEN SAT_MATH_SCORE = 540 THEN 28.5
WHEN SAT_MATH_SCORE = 550 THEN 28.5
WHEN SAT_MATH_SCORE = 560 THEN 29
WHEN SAT_MATH_SCORE = 570 THEN 29.5
WHEN SAT_MATH_SCORE = 580 THEN 30
WHEN SAT_MATH_SCORE = 590 THEN 30.5
WHEN SAT_MATH_SCORE = 600 THEN 31
WHEN SAT_MATH_SCORE = 610 THEN 31.5
WHEN SAT_MATH_SCORE = 620 THEN 32
WHEN SAT_MATH_SCORE = 630 THEN 32.5
WHEN SAT_MATH_SCORE = 640 THEN 33
WHEN SAT_MATH_SCORE = 650 THEN 33.5
WHEN SAT_MATH_SCORE = 660 THEN 34.5
WHEN SAT_MATH_SCORE = 670 THEN 35
WHEN SAT_MATH_SCORE = 680 THEN 35.5
WHEN SAT_MATH_SCORE = 690 THEN 36
WHEN SAT_MATH_SCORE = 700 THEN 36.5
WHEN SAT_MATH_SCORE = 710 THEN 37
WHEN SAT_MATH_SCORE = 720 THEN 37.5
WHEN SAT_MATH_SCORE = 730 THEN 38
WHEN SAT_MATH_SCORE = 740 THEN 38
WHEN SAT_MATH_SCORE = 750 THEN 38.5
WHEN SAT_MATH_SCORE = 760 THEN 39
WHEN SAT_MATH_SCORE = 770 THEN 39
WHEN SAT_MATH_SCORE = 780 THEN 39.5
WHEN SAT_MATH_SCORE = 790 THEN 40
WHEN SAT_MATH_SCORE = 800 THEN 40
ELSE NULL
END SAT_MT_CONV_SCORE,      -- Added Sept 2016 
       SAT_PAM_SCORE,       -- Sept 2016 
       SAT_PSDA_SCORE,      -- Sept 2016 
       SAT_RT_SCORE,
CASE 
WHEN SAT_VERB_SCORE = 200 THEN 10
WHEN SAT_VERB_SCORE = 210 THEN 11
WHEN SAT_VERB_SCORE = 220 THEN 12
WHEN SAT_VERB_SCORE = 230 THEN 13
WHEN SAT_VERB_SCORE = 240 THEN 13
WHEN SAT_VERB_SCORE = 250 THEN 14
WHEN SAT_VERB_SCORE = 260 THEN 15
WHEN SAT_VERB_SCORE = 270 THEN 16
WHEN SAT_VERB_SCORE = 280 THEN 17
WHEN SAT_VERB_SCORE = 290 THEN 17
WHEN SAT_VERB_SCORE = 300 THEN 18
WHEN SAT_VERB_SCORE = 310 THEN 18
WHEN SAT_VERB_SCORE = 320 THEN 18
WHEN SAT_VERB_SCORE = 330 THEN 19
WHEN SAT_VERB_SCORE = 340 THEN 19
WHEN SAT_VERB_SCORE = 350 THEN 19
WHEN SAT_VERB_SCORE = 360 THEN 20
WHEN SAT_VERB_SCORE = 370 THEN 20
WHEN SAT_VERB_SCORE = 380 THEN 21
WHEN SAT_VERB_SCORE = 390 THEN 21
WHEN SAT_VERB_SCORE = 400 THEN 22
WHEN SAT_VERB_SCORE = 410 THEN 22
WHEN SAT_VERB_SCORE = 420 THEN 23
WHEN SAT_VERB_SCORE = 430 THEN 24
WHEN SAT_VERB_SCORE = 440 THEN 24
WHEN SAT_VERB_SCORE = 450 THEN 25
WHEN SAT_VERB_SCORE = 460 THEN 25
WHEN SAT_VERB_SCORE = 470 THEN 26
WHEN SAT_VERB_SCORE = 480 THEN 26
WHEN SAT_VERB_SCORE = 490 THEN 27
WHEN SAT_VERB_SCORE = 500 THEN 27
WHEN SAT_VERB_SCORE = 510 THEN 28
WHEN SAT_VERB_SCORE = 520 THEN 28
WHEN SAT_VERB_SCORE = 530 THEN 29
WHEN SAT_VERB_SCORE = 540 THEN 29
WHEN SAT_VERB_SCORE = 550 THEN 30
WHEN SAT_VERB_SCORE = 560 THEN 30
WHEN SAT_VERB_SCORE = 570 THEN 31
WHEN SAT_VERB_SCORE = 580 THEN 31
WHEN SAT_VERB_SCORE = 590 THEN 32
WHEN SAT_VERB_SCORE = 600 THEN 32
WHEN SAT_VERB_SCORE = 610 THEN 33
WHEN SAT_VERB_SCORE = 620 THEN 33
WHEN SAT_VERB_SCORE = 630 THEN 34
WHEN SAT_VERB_SCORE = 640 THEN 34
WHEN SAT_VERB_SCORE = 650 THEN 35
WHEN SAT_VERB_SCORE = 660 THEN 35
WHEN SAT_VERB_SCORE = 670 THEN 36
WHEN SAT_VERB_SCORE = 680 THEN 36
WHEN SAT_VERB_SCORE = 690 THEN 37
WHEN SAT_VERB_SCORE = 700 THEN 37
WHEN SAT_VERB_SCORE = 710 THEN 37
WHEN SAT_VERB_SCORE = 720 THEN 38
WHEN SAT_VERB_SCORE = 730 THEN 38
WHEN SAT_VERB_SCORE = 740 THEN 38
WHEN SAT_VERB_SCORE = 750 THEN 39
WHEN SAT_VERB_SCORE = 760 THEN 39
WHEN SAT_VERB_SCORE = 770 THEN 39
WHEN SAT_VERB_SCORE = 780 THEN 40
WHEN SAT_VERB_SCORE = 790 THEN 40
WHEN SAT_VERB_SCORE = 800 THEN 40
ELSE NULL
END SAT_RT_CONV_SCORE,      -- Added Sept 2016 
       SAT_RWC_SCORE,       -- Sept 2016 
       SAT_SEC_SCORE,       -- Sept 2016 
       SAT_TOTAL_SCORE, 
CASE 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 400 THEN 400 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 410 THEN 420 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 420 THEN 430 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 430 THEN 450 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 440 THEN 460 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 450 THEN 480 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 460 THEN 490 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 470 THEN 510 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 480 THEN 520 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 490 THEN 530 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 500 THEN 550 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 510 THEN 560 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 520 THEN 580 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 530 THEN 590 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 540 THEN 610 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 550 THEN 620 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 560 THEN 640 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 570 THEN 650 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 580 THEN 670 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 590 THEN 680 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 600 THEN 700 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 610 THEN 710 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 620 THEN 720 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 630 THEN 730 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 640 THEN 740 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 650 THEN 750 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 660 THEN 750 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 670 THEN 760 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 680 THEN 770 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 690 THEN 780 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 700 THEN 790 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 710 THEN 800 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 720 THEN 810 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 730 THEN 820 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 740 THEN 830 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 750 THEN 840 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 760 THEN 850 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 770 THEN 860 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 780 THEN 860 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 790 THEN 870 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 800 THEN 880 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 810 THEN 890 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 820 THEN 900 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 830 THEN 910 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 840 THEN 920 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 850 THEN 930 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 860 THEN 940 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 870 THEN 950 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 880 THEN 960 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 890 THEN 970 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 900 THEN 980 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 910 THEN 990 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 920 THEN 1000 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 930 THEN 1010 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 940 THEN 1020 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 950 THEN 1030 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 960 THEN 1040 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 970 THEN 1050 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 980 THEN 1060 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 990 THEN 1070 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1000 THEN 1080 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1010 THEN 1090 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1020 THEN 1100 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1030 THEN 1110 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1040 THEN 1120 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1050 THEN 1130 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1060 THEN 1130 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1070 THEN 1140 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1080 THEN 1150 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1090 THEN 1160 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1100 THEN 1170 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1110 THEN 1180 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1120 THEN 1190 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1130 THEN 1200 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1140 THEN 1210 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1150 THEN 1220 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1160 THEN 1230 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1170 THEN 1240 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1180 THEN 1250 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1190 THEN 1260 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1200 THEN 1270 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1210 THEN 1280 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1220 THEN 1290 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1230 THEN 1300 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1240 THEN 1310 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1250 THEN 1310 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1260 THEN 1320 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1270 THEN 1330 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1280 THEN 1340 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1290 THEN 1350 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1300 THEN 1360 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1310 THEN 1370 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1320 THEN 1380 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1330 THEN 1390 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1340 THEN 1400 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1350 THEN 1410 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1360 THEN 1420 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1370 THEN 1420 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1380 THEN 1430 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1390 THEN 1440 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1400 THEN 1450 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1410 THEN 1460 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1420 THEN 1470 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1430 THEN 1480 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1440 THEN 1480 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1450 THEN 1490 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1460 THEN 1500 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1470 THEN 1510 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1480 THEN 1510 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1490 THEN 1520 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1500 THEN 1530 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1510 THEN 1540 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1520 THEN 1540 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1530 THEN 1550 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1540 THEN 1560 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1550 THEN 1560 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1560 THEN 1570 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1570 THEN 1580 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1580 THEN 1590 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1590 THEN 1590 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE = 1600 THEN 1600 
ELSE NULL
END SAT_TOTAL_1600_CONV_SCORE,      -- Added Sept 2016 
CASE 
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     600    THEN    400
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     610    THEN    410
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     620    THEN    420
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     630    THEN    430
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     640    THEN    440
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     650    THEN    450
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     660    THEN    460
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     670    THEN    470
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     680    THEN    480
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     690    THEN    490
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     700    THEN    500
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     710    THEN    510
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     720    THEN    520
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     730    THEN    530
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     740    THEN    540
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     750    THEN    550
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     760    THEN    560
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     770    THEN    580
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     780    THEN    590
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     790    THEN    600
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     800    THEN    610
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     810    THEN    620
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     820    THEN    630
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     830    THEN    640
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     840    THEN    650
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     850    THEN    660
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     860    THEN    670
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     870    THEN    680
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     880    THEN    690
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     890    THEN    690
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     900    THEN    700
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     910    THEN    710
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     920    THEN    710
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     930    THEN    720
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     940    THEN    730
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     950    THEN    730
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     960    THEN    740
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     970    THEN    740
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     980    THEN    750
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     990    THEN    760
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1000    THEN    760
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1010    THEN    770
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1020    THEN    780
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1030    THEN    780
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1040    THEN    790
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1050    THEN    800
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1060    THEN    800
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1070    THEN    810
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1080    THEN    810
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1090    THEN    820
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1100    THEN    830
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1110    THEN    830
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1120    THEN    840
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1130    THEN    850
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1140    THEN    850
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1150    THEN    860
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1160    THEN    870
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1170    THEN    870
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1180    THEN    880
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1190    THEN    890
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1200    THEN    890
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1210    THEN    900
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1220    THEN    910
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1230    THEN    910
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1240    THEN    920
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1250    THEN    930
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1260    THEN    930
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1270    THEN    940
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1280    THEN    950
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1290    THEN    950
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1300    THEN    960
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1310    THEN    970
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1320    THEN    980
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1330    THEN    980
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1340    THEN    990
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1350    THEN    1000
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1360    THEN    1000
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1370    THEN    1010
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1380    THEN    1020
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1390    THEN    1020
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1400    THEN    1030
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1410    THEN    1030
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1420    THEN    1040
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1430    THEN    1050
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1440    THEN    1050
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1450    THEN    1060
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1460    THEN    1070
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1470    THEN    1070
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1480    THEN    1080
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1490    THEN    1090
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1500    THEN    1090
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1510    THEN    1100
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1520    THEN    1110
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1530    THEN    1110
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1540    THEN    1120
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1550    THEN    1120
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1560    THEN    1130
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1570    THEN    1140
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1580    THEN    1140
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1590    THEN    1150
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1600    THEN    1160
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1610    THEN    1160
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1620    THEN    1170
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1630    THEN    1180
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1640    THEN    1180
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1650    THEN    1190
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1660    THEN    1200
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1670    THEN    1200
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1680    THEN    1210
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1690    THEN    1210
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1700    THEN    1220
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1710    THEN    1230
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1720    THEN    1230
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1730    THEN    1240
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1740    THEN    1250
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1750    THEN    1250
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1760    THEN    1260
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1770    THEN    1270
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1780    THEN    1270
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1790    THEN    1280
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1800    THEN    1290
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1810    THEN    1290
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1820    THEN    1300
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1830    THEN    1300
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1840    THEN    1310
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1850    THEN    1320
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1860    THEN    1320
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1870    THEN    1330
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1880    THEN    1340
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1890    THEN    1340
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1900    THEN    1350
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1910    THEN    1350
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1920    THEN    1360
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1930    THEN    1370
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1940    THEN    1370
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1950    THEN    1380
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1960    THEN    1380
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1970    THEN    1390
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1980    THEN    1400
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     1990    THEN    1400
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2000    THEN    1410
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2010    THEN    1410
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2020    THEN    1420
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2030    THEN    1430
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2040    THEN    1430
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2050    THEN    1440
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2060    THEN    1440
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2070    THEN    1450
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2080    THEN    1450
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2090    THEN    1460
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2100    THEN    1470
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2110    THEN    1470
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2120    THEN    1480
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2130    THEN    1480
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2140    THEN    1490
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2150    THEN    1490
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2160    THEN    1500
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2170    THEN    1500
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2180    THEN    1510
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2190    THEN    1510
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2200    THEN    1510
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2210    THEN    1520
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2220    THEN    1520
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2230    THEN    1530
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2240    THEN    1530
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2250    THEN    1540
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2260    THEN    1540
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2270    THEN    1550
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2280    THEN    1550
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2290    THEN    1550
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2300    THEN    1560
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2310    THEN    1560
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2320    THEN    1570
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2330    THEN    1570
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2340    THEN    1580
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2350    THEN    1580
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2360    THEN    1590
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2370    THEN    1590
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2380    THEN    1590
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2390    THEN    1600
WHEN SAT_MATH_SCORE + SAT_VERB_SCORE + SAT_WR_SCORE =     2400    THEN    1600
ELSE NULL
END SAT_TOTAL_2400_CONV_SCORE,      -- Added Sept 2016 
       SAT_VERB_SCORE, 
       SAT_WLT_SCORE, 
CASE 
WHEN SAT_WR_SCORE = 200 THEN 10
WHEN SAT_WR_SCORE = 210 THEN 11
WHEN SAT_WR_SCORE = 220 THEN 11
WHEN SAT_WR_SCORE = 230 THEN 12
WHEN SAT_WR_SCORE = 240 THEN 13
WHEN SAT_WR_SCORE = 250 THEN 14
WHEN SAT_WR_SCORE = 260 THEN 14
WHEN SAT_WR_SCORE = 270 THEN 15
WHEN SAT_WR_SCORE = 280 THEN 16
WHEN SAT_WR_SCORE = 290 THEN 17
WHEN SAT_WR_SCORE = 300 THEN 17
WHEN SAT_WR_SCORE = 310 THEN 18
WHEN SAT_WR_SCORE = 320 THEN 18
WHEN SAT_WR_SCORE = 330 THEN 19
WHEN SAT_WR_SCORE = 340 THEN 19
WHEN SAT_WR_SCORE = 350 THEN 20
WHEN SAT_WR_SCORE = 360 THEN 21
WHEN SAT_WR_SCORE = 370 THEN 21
WHEN SAT_WR_SCORE = 380 THEN 22
WHEN SAT_WR_SCORE = 390 THEN 22
WHEN SAT_WR_SCORE = 400 THEN 23
WHEN SAT_WR_SCORE = 410 THEN 24
WHEN SAT_WR_SCORE = 420 THEN 24
WHEN SAT_WR_SCORE = 430 THEN 25
WHEN SAT_WR_SCORE = 440 THEN 25
WHEN SAT_WR_SCORE = 450 THEN 26
WHEN SAT_WR_SCORE = 460 THEN 27
WHEN SAT_WR_SCORE = 470 THEN 27
WHEN SAT_WR_SCORE = 480 THEN 28
WHEN SAT_WR_SCORE = 490 THEN 28
WHEN SAT_WR_SCORE = 500 THEN 28
WHEN SAT_WR_SCORE = 510 THEN 29
WHEN SAT_WR_SCORE = 520 THEN 29
WHEN SAT_WR_SCORE = 530 THEN 30
WHEN SAT_WR_SCORE = 540 THEN 30
WHEN SAT_WR_SCORE = 550 THEN 31
WHEN SAT_WR_SCORE = 560 THEN 31
WHEN SAT_WR_SCORE = 570 THEN 32
WHEN SAT_WR_SCORE = 580 THEN 32
WHEN SAT_WR_SCORE = 590 THEN 33
WHEN SAT_WR_SCORE = 600 THEN 33
WHEN SAT_WR_SCORE = 610 THEN 33
WHEN SAT_WR_SCORE = 620 THEN 34
WHEN SAT_WR_SCORE = 630 THEN 34
WHEN SAT_WR_SCORE = 640 THEN 35
WHEN SAT_WR_SCORE = 650 THEN 35
WHEN SAT_WR_SCORE = 660 THEN 35
WHEN SAT_WR_SCORE = 670 THEN 36
WHEN SAT_WR_SCORE = 680 THEN 36
WHEN SAT_WR_SCORE = 690 THEN 36
WHEN SAT_WR_SCORE = 700 THEN 37
WHEN SAT_WR_SCORE = 710 THEN 37
WHEN SAT_WR_SCORE = 720 THEN 37
WHEN SAT_WR_SCORE = 730 THEN 38
WHEN SAT_WR_SCORE = 740 THEN 38
WHEN SAT_WR_SCORE = 750 THEN 38
WHEN SAT_WR_SCORE = 760 THEN 39
WHEN SAT_WR_SCORE = 770 THEN 39
WHEN SAT_WR_SCORE = 780 THEN 40
WHEN SAT_WR_SCORE = 790 THEN 40
WHEN SAT_WR_SCORE = 800 THEN 40
ELSE NULL
END SAT_WLT_CONV_SCORE,      -- Added Sept 2016 
       SAT_WR_SCORE,
       TOEFL_COMPP_SCORE, 
       TOEFL_IBTT_SCORE, 
       UMDAR_INDEX_SCORE,
       UMLOW_INDEX_SCORE
from T1
;
strSqlCommand   := 'SET intRowCount';
intRowCount     := SQL%ROWCOUNT;

strSqlCommand := 'commit';
commit;

strMessage01    := '# of UM_F_EXT_TESTSCORE_AGG rows inserted: ' || TO_CHAR(intRowCount,'999,999,999,999');
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_DETAIL';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_DETAIL
        (
                i_TargetTableName   => 'UM_F_EXT_TESTSCORE_AGG',
                i_Action            => 'INSERT',
                i_RowCount          => intRowCount
        );

strMessage01    := 'Enabling Indexes for table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

strSqlDynamic   := 'alter table CSMRT_OWNER.UM_F_EXT_TESTSCORE_AGG enable constraint PK_UM_F_EXT_TESTSCORE_AGG';
strSqlCommand   := 'SMT_UTILITY.EXECUTE_IMMEDIATE: ' || strSqlDynamic;
COMMON_OWNER.SMT_UTILITY.EXECUTE_IMMEDIATE
                (
                i_SqlStatement          => strSqlDynamic,
                i_MaxTries              => 10,
                i_WaitSeconds           => 10,
                o_Tries                 => intTries
                );
				
COMMON_OWNER.SMT_INDEX.ALL_REBUILD('CSMRT_OWNER','UM_F_EXT_TESTSCORE_AGG');

strSqlCommand := 'SMT_PROCESS_LOG.PROCESS_SUCCESS';
COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_SUCCESS;

strMessage01    := strProcessName || ' is complete.';
COMMON_OWNER.SMT_LOG.PUT_MESSAGE(i_Message => strMessage01);

EXCEPTION
    WHEN OTHERS THEN

        COMMON_OWNER.SMT_PROCESS_LOG.PROCESS_EXCEPTION
                (
                        i_SqlCommand   => strSqlCommand,
                        i_SqlCode      => SQLCODE,
                        i_SqlErrm      => SQLERRM
                );

END UM_F_EXT_TESTSCORE_AGG_P;
/
